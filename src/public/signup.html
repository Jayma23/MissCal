<!DOCTYPE html>
<html lang="en">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="shortcut icon" href="/favicon.png" type="image/x-icon">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up - Miss Cal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(to right, #FDB515, #FFD166);
            color: #333;
        }
        .main-header {
            background: #003262;
            color: white;
            text-align: center;
            padding: 50px 20px;
            animation: fadeInDown 1s ease-in-out;
        }
        .auth-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: calc(100vh - 150px);
            padding: 30px 0;
        }
        .auth-box {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
            width: 400px;
            text-align: center;
            animation: fadeInUp 1s ease-in-out;
            transition: transform 0.3s ease;
        }
        .auth-box:hover {
            transform: translateY(-5px);
        }
        .form-control {
            border-radius: 50px;
            padding: 12px 20px;
            transition: all 0.3s;
        }
        .form-control:focus {
            border-color: #003262;
            box-shadow: 0 0 0 0.25rem rgba(0, 50, 98, 0.25);
            transform: scale(1.02);
        }
        .input-group {
            margin-bottom: 15px;
        }
        .input-group-text {
            border-radius: 50px 0 0 50px;
            background-color: #003262;
            color: white;
        }
        .password-toggle {
            cursor: pointer;
            user-select: none;
        }
        .btn-custom {
            background: #003262;
            color: white;
            transition: 0.3s;
            font-weight: 600;
            border-radius: 50px;
            padding: 12px;
        }
        .btn-custom:hover {
            background: #001F3F;
            transform: scale(1.05);
        }
        .password-strength {
            height: 5px;
            margin-top: -10px;
            margin-bottom: 15px;
            border-radius: 5px;
            transition: all 0.3s;
        }
        .footer {
            background: #003262;
            color: #e0a814;
            text-align: center;
            padding: 10px 0;
            width: 100%;
        }
        .form-step {
            display: none;
        }
        .form-step.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }
        .progress-container {
            margin-bottom: 20px;
        }
        .progress {
            height: 8px;
            background-color: #f0f0f0;
        }
        .progress-bar {
            background-color: #003262;
            transition: width 0.3s ease;
        }
        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .step {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: #e0e0e0;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .step.active {
            background-color: #003262;
            color: white;
        }
        .step.completed {
            background-color: #28a745;
            color: white;
        }
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .shake {
            animation: shake 0.5s;
        }
        @keyframes shake {
            0%, 100% {transform: translateX(0);}
            10%, 30%, 50%, 70%, 90% {transform: translateX(-5px);}
            20%, 40%, 60%, 80% {transform: translateX(5px);}
        }
        .loading {
            display: none;
            text-align: center;
            margin: 20px 0;
        }
        .loading .spinner-border {
            width: 3rem;
            height: 3rem;
        }
        .tooltip-icon {
            margin-left: 5px;
            color: #003262;
            cursor: pointer;
        }
    </style>
</head>
<body>
<header class="main-header">
    <div class="container">
        <h1 class="display-4"><i class="fas fa-graduation-cap me-2"></i>Join Miss Cal</h1>
    </div>
</header>

<main class="auth-container">
    <div class="auth-box">
        <h2>Create Your Account</h2>

        <div class="progress-container">
            <div class="step-indicator">
                <div class="step active">1</div>
                <div class="step">2</div>
                <div class="step">3</div>
            </div>
            <div class="progress">
                <div class="progress-bar" role="progressbar" style="width: 33%" aria-valuenow="33" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
        </div>

        <form id="signupForm">
            <!-- Step 1: Basic Information -->
            <div class="form-step active" id="step1">
                <div class="input-group">
                    <span class="input-group-text"><i class="fas fa-user"></i></span>
                    <input type="text" class="form-control" id="full_name" name="full_name" placeholder="Full Name" required>
                </div>

                <div class="input-group">
                    <span class="input-group-text"><i class="fas fa-envelope"></i></span>
                    <input type="email" class="form-control" id="email" name="email" placeholder="@berkeley.edu Email" required>
                    <span class="tooltip-icon" data-bs-toggle="tooltip" data-bs-placement="right" title="Please use your Berkeley email address">
                        <i class="fas fa-info-circle"></i>
                    </span>
                </div>

                <div class="mt-4">
                    <button type="button" class="btn btn-custom w-100 next-btn" data-step="1">Continue <i class="fas fa-arrow-right ms-1"></i></button>
                </div>
            </div>

            <!-- Step 2: Password -->
            <div class="form-step" id="step2">
                <div class="input-group">
                    <span class="input-group-text"><i class="fas fa-lock"></i></span>
                    <input type="password" class="form-control" id="password" name="password" placeholder="Password" required>
                    <span class="input-group-text password-toggle" onclick="togglePassword('password')">
                        <i class="fas fa-eye"></i>
                    </span>
                </div>

                <div class="password-strength" id="passwordStrength"></div>
                <div id="passwordFeedback" class="text-start mb-3 small"></div>

                <div class="input-group">
                    <span class="input-group-text"><i class="fas fa-lock"></i></span>
                    <input type="password" class="form-control" id="confirm_password" name="confirm_password" placeholder="Confirm Password" required>
                    <span class="input-group-text password-toggle" onclick="togglePassword('confirm_password')">
                        <i class="fas fa-eye"></i>
                    </span>
                </div>

                <div class="mt-4 d-flex justify-content-between">
                    <button type="button" class="btn btn-outline-secondary prev-btn" data-step="2"><i class="fas fa-arrow-left me-1"></i> Back</button>
                    <button type="button" class="btn btn-custom next-btn" data-step="2">Continue <i class="fas fa-arrow-right ms-1"></i></button>
                </div>
            </div>

            <!-- Step 3: Confirmation -->
            <div class="form-step" id="step3">
                <div class="mb-4">
                    <h4 class="mb-3">Confirm Your Details</h4>
                    <div class="card mb-3">
                        <div class="card-body text-start">
                            <p><strong>Name:</strong> <span id="summary_name"></span></p>
                            <p><strong>Email:</strong> <span id="summary_email"></span></p>
                            <p><strong>Password:</strong> ••••••••</p>
                        </div>
                    </div>

                    <div class="form-check text-start mb-3">
                        <input class="form-check-input" type="checkbox" id="terms_agree" required>
                        <label class="form-check-label" for="terms_agree">
                            I agree to the <a href="#" data-bs-toggle="modal" data-bs-target="#termsModal">Terms and Conditions</a>
                        </label>
                    </div>
                </div>

                <div class="d-flex justify-content-between">
                    <button type="button" class="btn btn-outline-secondary prev-btn" data-step="3"><i class="fas fa-arrow-left me-1"></i> Back</button>
                    <button type="submit" class="btn btn-custom" id="submitBtn">Create Account</button>
                </div>
            </div>

            <div class="loading" id="loadingIndicator">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <p class="mt-2">Creating your account...</p>
            </div>
        </form>

        <p class="mt-3">Already have an account? <a href="sign-in.html" class="text-decoration-none fw-bold">Sign In</a></p>
    </div>
</main>

<!-- Terms Modal -->
<div class="modal fade" id="termsModal" tabindex="-1" aria-labelledby="termsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="termsModalLabel">Terms and Conditions</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <h1>Miss Cal – Terms of Use</h1>
                <p><strong>Effective Date:</strong> April 6, 2025</p>

                <p><strong>PLEASE READ THESE TERMS OF USE (\"Terms\") CAREFULLY BEFORE USING THE MISS CAL WEBSITE OR ANY RELATED SERVICES (COLLECTIVELY, THE \"Service\"). BY ACCESSING OR USING THE SERVICE, YOU (\"User\" or \"you\") AGREE TO BE LEGALLY BOUND BY THESE TERMS AND OUR PRIVACY POLICY. IF YOU DO NOT AGREE, DO NOT ACCESS OR USE THE SERVICE.</strong></p>

                <p>Miss Cal is an independent project and is not affiliated with, endorsed by, or sponsored by the University of California, Berkeley.</p>

                <h2>1. Acceptance of Terms</h2>
                <ol>
                    <li>These Terms constitute a legally binding agreement between you and Miss Cal.</li>
                    <li>Supplemental terms or rules may apply to specific features and are hereby incorporated by reference.</li>
                </ol>

                <h2>2. Eligibility</h2>
                <ol>
                    <li>You must be at least 18 years old, or the age of majority in your jurisdiction, or have verifiable parental or guardian consent.</li>
                    <li>You represent that you have not been previously suspended or removed from the Service.</li>
                    <li>You affirm that all information you provide is accurate, current, and complete.</li>
                </ol>

                <h2>3. Account Registration & Security</h2>
                <ol>
                    <li>To participate in voting or competitions you must create an account and provide a valid email address.</li>
                    <li>You are solely responsible for maintaining the confidentiality of your credentials and for all activities under your account.</li>
                    <li>You agree to notify us immediately of any unauthorized use or security breach.</li>
                </ol>

                <h2>4. Voting Rules</h2>
                <ol>
                    <li>Unless otherwise stated, each eligible voter may cast one vote per voting period.</li>
                    <li>Use of bots, scripts, or other automated means to vote is prohibited.</li>
                    <li>We reserve the right to audit votes and to invalidate or delete any votes we reasonably believe were cast in violation of these Terms.</li>
                </ol>

                <h2>5. Content Submission & License</h2>
                <ol>
                    <li>Contestants and users may submit photographs, videos, text, and other materials ("User Content").</li>
                    <li>By submitting User Content, you grant Miss Cal a worldwide, royalty‑free, non‑exclusive, transferable, and sublicensable license to use, reproduce, modify, adapt, publish, translate, create derivative works from, distribute, publicly perform, and publicly display such User Content in connection with the Service and Miss Cal’s promotional activities.</li>
                    <li>You represent and warrant that you own or have the necessary licenses, rights, and permissions to submit the User Content and to grant the foregoing license.</li>
                    <li>You acknowledge that User Content may be publicly viewable and that you have no expectation of privacy with respect to such content.</li>
                </ol>

                <h2>6. Intellectual Property</h2>
                <ol>
                    <li>The Service and all materials therein, other than User Content, are the property of Miss Cal or its licensors and are protected by copyright, trademark, and other laws.</li>
                    <li>Except as expressly provided in these Terms, no part of the Service may be copied, reproduced, republished, uploaded, posted, transmitted, or distributed in any way without Miss Cal’s prior written permission.</li>
                </ol>

                <h2>7. Code of Conduct</h2>
                <ol>
                    <li>You agree not to upload, post, transmit, or otherwise make available any User Content that:
                        <ul>
                            <li>is unlawful, harmful, threatening, abusive, harassing, defamatory, vulgar, obscene, hateful, or otherwise objectionable;</li>
                            <li>infringes any patent, trademark, trade secret, copyright, or other proprietary rights of any party;</li>
                            <li>violates any person’s privacy or publicity rights;</li>
                            <li>impersonates any person or entity or falsely states or otherwise misrepresents your affiliation with a person or entity.</li>
                        </ul>
                    </li>
                    <li>You will not engage in any activity that interferes with or disrupts the Service or its infrastructure.</li>
                </ol>

                <h2>8. Prohibited Activities</h2>
                <ol>
                    <li>Reverse engineering or decompiling any part of the Service.</li>
                    <li>Introducing viruses, malware, or any other harmful code.</li>
                    <li>Using the Service for unauthorized advertising or commercial solicitation.</li>
                    <li>Attempting to access other users’ accounts or private information.</li>
                </ol>

                <h2>9. Privacy</h2>
                <ol>
                    <li>Our Privacy Policy describes how we collect, use, and disclose your personal information and is incorporated by reference into these Terms.</li>
                    <li>By using the Service, you consent to that collection and use as described.</li>
                </ol>

                <h2>10. Third-Party Links & Services</h2>
                <ol>
                    <li>The Service may contain links to third‑party websites or services not owned or controlled by Miss Cal.</li>
                    <li>We are not responsible for any third‑party content, privacy practices, or service availability.</li>
                </ol>

                <h2>11. Disclaimers</h2>
                <ol>
                    <li>THE SERVICE IS PROVIDED \"AS IS\" AND \"AS AVAILABLE.\" MISS CAL DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED.</li>
                    <li>WE DO NOT GUARANTEE THAT THE SERVICE WILL BE UNINTERRUPTED, ERROR‑FREE, OR FREE OF HARMFUL COMPONENTS.</li>
                </ol>

                <h2>12. Limitation of Liability</h2>
                <p>TO THE MAXIMUM EXTENT PERMITTED BY LAW, MISS CAL SHALL NOT BE LIABLE FOR ANY INDIRECT, INCIDENTAL, SPECIAL, OR CONSEQUENTIAL DAMAGES, INCLUDING LOSS OF DATA OR PROFITS.</p>

                <h2>13. Indemnification</h2>
                <p>You agree to indemnify and hold harmless Miss Cal from any claims or liabilities arising from your use of the Service or breach of these Terms.</p>

                <h2>14. Termination</h2>
                <ol>
                    <li>We may suspend or terminate your access at any time for any reason.</li>
                    <li>Sections regarding ownership, warranties, and liability limitations survive termination.</li>
                </ol>

                <h2>15. Governing Law & Venue</h2>
                <ol>
                    <li>These Terms are governed by California law.</li>
                    <li>Disputes shall be resolved in Alameda County, California courts.</li>
                </ol>

                <h2>16. Changes to Terms</h2>
                <ol>
                    <li>We may update these Terms at any time.</li>
                    <li>Material changes will be posted on the Service, and your continued use means acceptance.</li>
                </ol>

                <h2>17. Contact Information</h2>
                <ul>
                    <li>Email: <a href="mailto:support@misscal.net">support@misscal.net</a></li>
                    <li>Mail: Miss Cal, 123 Student Center, Berkeley, CA 94720</li>
                </ul>

                <hr>
                <p><em>Not Legal Advice: These Terms are provided for informational purposes only and do not constitute legal advice. Consult an attorney for compliance questions.</em></p>


                <!-- Add more terms content here -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-custom" data-bs-dismiss="modal" onclick="document.getElementById('terms_agree').checked = true;">I Agree</button>
            </div>
        </div>
    </div>
</div>

<footer class="footer">
    <p>&copy; 2024 College Life. All rights reserved.</p>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Initialize tooltips
    document.addEventListener('DOMContentLoaded', function() {
        const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
        tooltipTriggerList.map(function(tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
        });
    });

    // Password toggle functionality
    function togglePassword(inputId) {
        const input = document.getElementById(inputId);
        const icon = input.nextElementSibling.querySelector('i');

        if (input.type === 'password') {
            input.type = 'text';
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
        } else {
            input.type = 'password';
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
        }
    }

    // Form navigation
    const nextButtons = document.querySelectorAll('.next-btn');
    const prevButtons = document.querySelectorAll('.prev-btn');
    const formSteps = document.querySelectorAll('.form-step');
    const stepIndicators = document.querySelectorAll('.step');
    const progressBar = document.querySelector('.progress-bar');

    nextButtons.forEach(button => {
        button.addEventListener('click', () => {
            const currentStep = parseInt(button.getAttribute('data-step'));

            // Validate current step
            if (!validateStep(currentStep)) {
                return;
            }

            // Update summary on last step
            if (currentStep === 2) {
                document.getElementById('summary_name').textContent = document.getElementById('full_name').value;
                document.getElementById('summary_email').textContent = document.getElementById('email').value;
            }

            // Update progress and move to next step
            updateProgress(currentStep + 1);
        });
    });

    prevButtons.forEach(button => {
        button.addEventListener('click', () => {
            const currentStep = parseInt(button.getAttribute('data-step'));
            updateProgress(currentStep - 1);
        });
    });

    function updateProgress(step) {
        formSteps.forEach((formStep, index) => {
            formStep.classList.remove('active');
            stepIndicators[index].classList.remove('active', 'completed');

            if (index + 1 === step) {
                formStep.classList.add('active');
                stepIndicators[index].classList.add('active');
            } else if (index + 1 < step) {
                stepIndicators[index].classList.add('completed');
            }
        });

        document.getElementById(`step${step}`).classList.add('active');
        progressBar.style.width = `${(step / formSteps.length) * 100}%`;
    }

    function validateStep(step) {
        let isValid = true;

        if (step === 1) {
            const nameInput = document.getElementById('full_name');
            const emailInput = document.getElementById('email');

            if (!nameInput.value.trim()) {
                shakeElement(nameInput);
                isValid = false;
            }

            if (!emailInput.value.trim()) {
                shakeElement(emailInput);
                isValid = false;
            } else if (!emailInput.value.includes('@berkeley.edu')) {
                shakeElement(emailInput);
                alert('Please use a berkeley.edu email address');
                isValid = false;
            }
        } else if (step === 2) {
            const passwordInput = document.getElementById('password');
            const confirmInput = document.getElementById('confirm_password');

            if (!passwordInput.value) {
                shakeElement(passwordInput);
                isValid = false;
            }

            if (!confirmInput.value) {
                shakeElement(confirmInput);
                isValid = false;
            } else if (passwordInput.value !== confirmInput.value) {
                shakeElement(confirmInput);
                alert('Passwords do not match!');
                isValid = false;
            }
        }

        return isValid;
    }

    function shakeElement(element) {
        element.classList.add('shake');
        element.focus();
        setTimeout(() => {
            element.classList.remove('shake');
        }, 500);
    }

    // Password strength meter
    const passwordInput = document.getElementById('password');
    const strengthBar = document.getElementById('passwordStrength');
    const feedbackElem = document.getElementById('passwordFeedback');

    passwordInput.addEventListener('input', updatePasswordStrength);

    function updatePasswordStrength() {
        const password = passwordInput.value;
        let strength = 0;
        let feedback = '';

        if (password.length > 7) strength += 1;
        if (password.match(/[A-Z]/)) strength += 1;
        if (password.match(/[a-z]/)) strength += 1;
        if (password.match(/[0-9]/)) strength += 1;
        if (password.match(/[^A-Za-z0-9]/)) strength += 1;

        switch(strength) {
            case 0:
                strengthBar.style.width = '0%';
                strengthBar.style.backgroundColor = '';
                feedbackElem.innerHTML = '';
                break;
            case 1:
                strengthBar.style.width = '20%';
                strengthBar.style.backgroundColor = '#dc3545'; // red
                feedbackElem.innerHTML = '<i class="fas fa-times-circle text-danger"></i> Very weak password';
                break;
            case 2:
                strengthBar.style.width = '40%';
                strengthBar.style.backgroundColor = '#ffc107'; // yellow
                feedbackElem.innerHTML = '<i class="fas fa-exclamation-circle text-warning"></i> Weak password';
                break;
            case 3:
                strengthBar.style.width = '60%';
                strengthBar.style.backgroundColor = '#fd7e14'; // orange
                feedbackElem.innerHTML = '<i class="fas fa-exclamation-circle text-warning"></i> Moderate password';
                break;
            case 4:
                strengthBar.style.width = '80%';
                strengthBar.style.backgroundColor = '#20c997'; // teal
                feedbackElem.innerHTML = '<i class="fas fa-check-circle text-success"></i> Strong password';
                break;
            case 5:
                strengthBar.style.width = '100%';
                strengthBar.style.backgroundColor = '#28a745'; // green
                feedbackElem.innerHTML = '<i class="fas fa-check-circle text-success"></i> Very strong password';
                break;
        }
    }

    // Form submission - using your original backend code
    document.getElementById('signupForm').addEventListener('submit', async (event) => {
        event.preventDefault();

        // Ensure all steps are completed
        if (!validateStep(1) || !validateStep(2)) {
            updateProgress(1); // Go back to first step with issues
            return;
        }

        if (!document.getElementById('terms_agree').checked) {
            alert('Please agree to the terms and conditions');
            return;
        }

        const full_name = document.getElementById('full_name').value.trim();
        const email = document.getElementById('email').value.trim();
        const password = document.getElementById('password').value.trim();
        const confirmPassword = document.getElementById('confirm_password').value.trim();

        if (password !== confirmPassword) {
            alert('Passwords do not match!');
            return;
        }

        // Show loading indicator
        document.getElementById('loadingIndicator').style.display = 'block';
        document.getElementById('submitBtn').disabled = true;

        try {
            // Using your original backend endpoint
            const response = await fetch('https://server1.misscal.net/signup', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ full_name, email, password }),
            });

            // Hide loading indicator
            document.getElementById('loadingIndicator').style.display = 'none';
            document.getElementById('submitBtn').disabled = false;

            if (response.ok) {
                // Using your original redirect
                alert('Signup successful!, Please check your email or email spam to Verify your account. If you already voted through email, you are good. ');
                window.location.href = 'sign-in.html';
            } else {
                const error = await response.json();
                alert(error.message || 'Error signing up. Please try again.');
            }
        } catch (error) {
            console.error('Error:', error);
            alert('An error occurred while signing up. Please try again later.');

            // Hide loading indicator
            document.getElementById('loadingIndicator').style.display = 'none';
            document.getElementById('submitBtn').disabled = false;
        }
    });
</script>
</body>
</html>